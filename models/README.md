# 訓練模型使用說明

## 模型檔案說明

本目錄包含了敗血症預測模型的所有訓練好的模型檔案。

### 檔案命名規則
- 格式: `{特徵類型}_{模型名稱}.pkl`
- 特徵類型:
  - `a_x`: 僅結構化數據特徵
  - `y`: 僅主訴文本嵌入
  - `z`: 僅診斷文本嵌入
  - `a_y`: 結構化數據 + 主訴文本
  - `a_x_z`: 結構化數據 + 診斷文本
  - `a_z`: 結構化數據 + 主訴文本 + 診斷文本
- 模型名稱: DT(決策樹), SVM(支持向量機), RF(隨機森林), CNN(神經網路)

### 載入和使用模型

```python
import joblib
import numpy as np

# 載入模型
model = joblib.load('models/a_z_RF.pkl')  # 例如載入最佳組合的隨機森林模型

# 準備預測數據 (需要和訓練時相同的特徵順序和格式)
X_new = np.array([...])  # 新的病患數據

# 進行預測
y_pred = model.predict(X_new)  # 預測類別 (0: 無敗血症, 1: 有敗血症)
y_prob = model.predict_proba(X_new)[:, 1]  # 預測概率

print(f"預測結果: {y_pred[0]}")
print(f"敗血症概率: {y_prob[0]:.3f}")
```

### 注意事項
1. 使用模型前需確保輸入數據的預處理與訓練時一致
2. 結構化數據需要經過相同的標準化處理
3. 文本數據需要經過相同的BERT嵌入處理
4. 建議使用交叉驗證結果中表現最佳的模型組合
